<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Page de mots</title>
<style>
    body {
        font-family: Arial, sans-serif;
    }
    .container {
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
    }
    .input-group {
        margin-bottom: 15px;
    }
    label {
        display: block;
        margin-bottom: 5px;
    }
    input[type="text"] {
        width: 100%;
        padding: 8px;
        box-sizing: border-box;
    }
    button {
        padding: 10px 20px;
        background-color: #4CAF50;
        color: white;
        border: none;
        cursor: pointer;
    }
    button:hover {
        background-color: #45a049;
    }
    #result {
        margin-top: 20px;
    }
</style>
</head>
<body>

<div class="container">
    <h2>Recherche de mots</h2>
    
    <div class="input-group">
        <label for="mot1">Mot 1 :</label>
        <input type="text" id="mot1">
    </div>
    
    <div class="input-group">
        <label for="mot2">Mot 2 :</label>
        <input type="text" id="mot2">
    </div>
    
    <div class="input-group">
        <label for="mot3">Mot 3 :</label>
        <input type="text" id="mot3">
    </div>
    
    <div class="input-group">
        <label for="mot4">Mot 4 :</label>
        <input type="text" id="mot4">
    </div>
    
    <input type="file" id="inputFile" accept=".xlsx,.xls">
    <button onclick="rechercher()">Rechercher dans le fichier Excel</button>
    
    <div id="result"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
<script>
    function rechercher() {
        var mots = [
            document.getElementById('mot1').value,
            document.getElementById('mot2').value,
            document.getElementById('mot3').value,
            document.getElementById('mot4').value
        ];

        var inputFile = document.getElementById('inputFile').files[0];
        if (!inputFile) {
            alert('Veuillez sélectionner un fichier Excel.');
            return;
        }

        var fileReader = new FileReader();
        fileReader.onload = function(e) {
            var data = new Uint8Array(e.target.result);
            var workbook = XLSX.read(data, { type: 'array' });

            var sheet = workbook.Sheets[workbook.SheetNames[0]];

            var resultHTML = '';
            for (var rowNum = sheet['!range'].s.r; rowNum <= sheet['!range'].e.r; rowNum++) {
                var row = sheet[XLSX.utils.encode_row(rowNum)];
                var rowText = XLSX.utils.sheet_to_json(row, { header: 1 })[0].join(' ');
                var motTrouve = mots.find(function(mot) {
                    return rowText.includes(mot);
                });
                if (motTrouve) {
                    resultHTML += '<p>Ligne trouvée : ' + rowText + '</p>';
                }
            }

            if (resultHTML === '') {
                resultHTML = '<p>Aucune ligne correspondante trouvée.</p>';
            }

            document.getElementById('result').innerHTML = resultHTML;
        };
        fileReader.readAsArrayBuffer(inputFile);
    }
</script>

</body>
</html>
